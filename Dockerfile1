# Dockerfile
FROM php:7.3-apache

RUN apt-get update

# Install Postgre PDO
RUN apt-get install -y libpq-dev
RUN docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql
RUN docker-php-ext-install pdo pdo_pgsql pdo_pgsql
RUN apt-get install -y nodejs npm

COPY package.json /var/www/html
COPY package-lock.json /var/www/html
WORKDIR /var/www/html
RUN npm i -g npm
RUN npm install
RUN npm run prod

# COPY server/default.conf /usr/local/etc/php/

COPY . /var/www/html

RUN php artisan migrate
